<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>PureCloud Supervisor view</title>

    <link href='//fonts.googleapis.com/css?family=Lato:300,400' rel='stylesheet' async type='text/css'>
    <link rel="stylesheet" href="style.css">
    <!-- <link rel="stylesheet" href="https://dhqbrvplips7x.cloudfront.net/directory/5000/assets/vendor-076c7aa353d2434073d9cda6452233b2.css">
    <link rel="stylesheet" href="https://dhqbrvplips7x.cloudfront.net/directory/5000/assets/web-directory-cf58866683f864f6e81ea7b74c9eb2d9.css"> -->
    <link rel="stylesheet" href="https://dhqbrvplips7x.cloudfront.net/directory/5021/assets/vendor-86308f6496a85eb87aa076901bf383ed.css">
    <link rel="stylesheet" href="https://dhqbrvplips7x.cloudfront.net/directory/5021/assets/web-directory-42e39de6fc419de58d00cf867e36e804.css">

    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="https://sdk-cdn.mypurecloud.com/client-apps/1.0.0/purecloud-client-app-sdk.js"></script>
    <script src="https://sdk-cdn.mypurecloud.com/javascript/28.0.0/purecloud-platform-client-v2.min.js"></script>
</head>
<body class="purecloud-theme original-theme ember-application pace-done">
    <svg style="position: absolute; width: 0; height: 0; overflow: hidden;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <symbol viewBox="0 0 32 32" id="icon-phone">
            <path d="M13,12.77,15.4,10.4a3.22,3.22,0,0,0,.06-3.53L13.75,3.5a2.15,2.15,0,0,0-3.37-.77A11.57,11.57,0,0,0,6.63,8.36a6,6,0,0,0,.44,4.47l2,4L11.76,22l2.1,4.08a6,6,0,0,0,3.26,3,11.51,11.51,0,0,0,7,.28,2.11,2.11,0,0,0,1.32-3c-.66-1.32-1.32-2.59-2-3.92a3,3,0,0,0-2.65-1.6l-3.64.06Z"/>
        </symbol>
        <symbol viewBox="0 0 32 32" id="icon-callback">
            <path d="M29.65,24.91c-.55-1.1-1.16-2.21-1.71-3.37a2.5,2.5,0,0,0-2.26-1.38l-3.09.06-3.59-7,2-2a2.72,2.72,0,0,0,.06-3L19.66,5.27a1.83,1.83,0,0,0-2.87-.66,10,10,0,0,0-3.2,4.85A5.07,5.07,0,0,0,14,13.27l1.77,3.42L18,21.16l1.77,3.53a5.08,5.08,0,0,0,2.81,2.54,10,10,0,0,0,6,.28,1.89,1.89,0,0,0,1.1-2.59Z"/>
            <path d="M12,17.63h0l-5.41-.06,1.66-1.65A1.29,1.29,0,0,0,6.47,14.1L2.61,17.9h0a.77.77,0,0,0-.17.22c0,.06-.06.06-.06.11s-.06.06-.06.11-.06.11-.06.17-.06.06-.06.11-.06.17-.06.28h0l.06.06a.21.21,0,0,0,.06.17c0,.06.06.06.06.11s0,.06.06.11a.19.19,0,0,0,.06.11c0,.06.06.06.06.11s.06.11.11.17a.05.05,0,0,0,.06.06h0l3.81,3.86a1.29,1.29,0,0,0,.94.39,1.1,1.1,0,0,0,.88-.39,1.3,1.3,0,0,0,0-1.82L6.64,20.11H12.1a1.25,1.25,0,0,0,1.27-1.27A1.29,1.29,0,0,0,12,17.63Z"/>
        </symbol>
        <symbol viewBox="0 0 32 32" id="icon-chat">
            <path d="M16,3.13C8.41,3.13,2.23,8.26,2.23,14.66a10.21,10.21,0,0,0,2.48,6.57.68.68,0,0,1,.11.55l-2,6.29a.61.61,0,0,0,.88.72L9.9,25.2a.54.54,0,0,1,.5-.06,16.64,16.64,0,0,0,5.57,1c7.61,0,13.79-5.13,13.79-11.53S23.64,3.13,16,3.13Z"/>
        </symbol>
        <symbol viewBox="0 0 32 32" id="icon-envelope">
            <path d="M25.22,5H6.62c-2.37,0-4.3.5-4.41,2.87a.72.72,0,0,0,.44.66l11.59,5.9a3.69,3.69,0,0,0,1.71.39,4,4,0,0,0,1.6-.39L29.24,8.8A1,1,0,0,0,29.79,8V7.75C29.79,5.32,27.64,5,25.22,5Z"/>
            <path d="M3.26,12.44a.7.7,0,0,0-.66,0c-.44.22-.39.55-.39.88v10.1A3.58,3.58,0,0,0,5.79,27h20.8a3.2,3.2,0,0,0,3.2-3.2V13.1a.71.71,0,0,0-.5-.72,1.51,1.51,0,0,0-.88.11L17.44,18a3.39,3.39,0,0,1-3.09,0L3.26,12.44Z"/>
        </symbol>
    </svg>
    <nav class="ember-engine-queues-navigation" style="height: 50px">
        <div class="breadcrumb-bar ember-view" style="height: 50px">
            <ol class="breadcrumbs">
                <li id="txtConversations" class=" breadcrumb-interaction-search"></li>
            </ol>
        </div>
        <div class="navigation-right" style="height: 50px">
            <button class="btn-info right" onclick="window.location='./wizard/uninstall.html'">Uninstall App</button>
        </div>
    </nav>
    <div class="ember-engine-queues-main-content" style="padding-top: 20px">
        <div class="queues-engine-view default-filter-view interaction-search">
            <div class="interaction-search-content filter-view-content">
                <div class="main-content">
                    <div class="pager" style="margin-bottom: 20px">
                        <div id="txtSubscribe" class="floating field-title" style="display: inline-block;"></div>
                        <select id="ddlQueues" name="queues" onChange="subscribeToQueue()" style="display: inline-block;" dir="ltr"></select>
                    </div>                
                    <div class="filter-bar">
                        <div class="filter-sections">
                            <div class="filter-section filter-left media-type-filter ember-view">
                                <span class="all-media-types" onClick="allConversations()" style="font-size: 12px;">ALL</span>
                                <span class="media-type-filter-icon media-type-phone" onClick="phoneConversations()">
                                    <span class="media-icon ember-view">
                                        <svg class="svg-icon icon-phone">
                                            <use xlink:href="#icon-phone"></use>
                                        </svg>
                                    </span>
                                    <span class="media-type-filter-name filter-name-phone" style="font-size: 12px;">PHONE</span>
                                </span>
                                <span class="media-type-filter-icon media-type-callback" onClick="callbackConversations()">
                                    <span class="media-icon ember-view">
                                        <svg class="svg-icon icon-callback">
                                            <use xlink:href="#icon-callback"></use>
                                        </svg>
                                    </span>
                                    <span class="media-type-filter-name filter-name-phone" style="font-size: 12px;">CALLBACK</span>
                                </span>
                                <span class="media-type-filter-icon media-type-chat" onClick="chatConversations()">
                                    <span class="media-icon ember-view">
                                            <svg class="svg-icon icon-chat">
                                                <use xlink:href="#icon-chat"></use>
                                            </svg>
                                        </span>
                                        <span class="media-type-filter-name filter-name-phone" style="font-size: 12px;">CHAT</span>
                                </span>
                                <span class="media-type-filter-icon media-type-email" onClick="emailConversations()">
                                    <span class="media-icon ember-view">
                                        <svg class="svg-icon icon-envelope">
                                            <use xlink:href="#icon-envelope"></use>
                                        </svg>
                                    </span>
                                    <span class="media-type-filter-name filter-name-phone" style="font-size: 12px;">EMAIL</span>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="main-data-table l-scroll-table-stretch data-table column-picker-toggle ember-view">
                        <div class="dt-horiz-scrollable">
                            <table id="tblCallerDetails">
                                <thead class="dt-section dt-section-head">
                                    <tr class="dt-row header-row sortable-objects ember-view">
                                        <th id="txtConvId" style="display: none; padding: 5px"></th>
                                        <th id="txtConvType" style="padding: 5px"></th>
                                        <th id="txtName" style="padding: 5px"></th>
                                        <th id="txtANI" style="padding: 5px"></th>
                                        <th id="txtDNIS" style="padding: 5px"></th>
                                        <th id="txtState" style="padding: 5px"></th>
                                        <th id="txtWait" style="padding: 5px"></th>
                                        <th id="txtDuration" style="padding: 5px"></th>
                                    </tr>
                                </thead>
                                <tbody class="dt-section dt-section-body scrollable-section">
                                </tbody>
                            </table> 
                        </div>            
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import clientApp from './client_app.js';

        var queryString = window.location.search.substring(1);
        var pairs = queryString.split('&');
        var langTag = null;
        var pcEnv = null;
        for (var i = 0; i < pairs.length; i++)
        {
            var currParam = pairs[i].split('=');
            if(currParam[0] === 'langTag') {
                langTag = currParam[1];
            } else if(currParam[0] === 'pcEnvironment') {
                pcEnv = currParam[1];
            } else if(currParam[0] === 'environment' && pcEnv === null) {
                pcEnv = currParam[1];
            }
            
            if (langTag !== null) {
                $.getJSON('./language.json', function(data) {
                    $("#txtConversations").text(data[langTag].Conversations);
                    $("#txtSubscribe").text(data[langTag].Subscribe + ": ");
                    $("#txtConvId").text(data[langTag].ConversationID);
                    $("#txtConvType").text(data[langTag].Type);
                    $("#txtName").text(data[langTag].Name);
                    $("#txtANI").text(data[langTag].ANI);
                    $("#txtDNIS").text(data[langTag].DNIS);
                    $("#txtState").text(data[langTag].State);
                    $("#txtWait").text(data[langTag].WaitTime);
                    $("#txtDuration").text(data[langTag].Duration);
                });
            }
        }

        if(langTag === null){
            $.getJSON('./language.json', function(data) {
                $("#txtConversations").text(data["en-us"].Conversations);
                $("#txtSubscribe").text(data["en-us"].Subscribe + ": ");
                $("#txtConvId").text(data["en-us"].ConversationID);
                $("#txtConvType").text(data["en-us"].Type);
                $("#txtName").text(data["en-us"].Name);
                $("#txtANI").text(data["en-us"].ANI);
                $("#txtDNIS").text(data["en-us"].DNIS);
                $("#txtState").text(data["en-us"].State);
                $("#txtWait").text(data["en-us"].WaitTime);
                $("#txtDuration").text(data["en-us"].Duration);
            });
        }
        
        clientApp.setup(pcEnv, langTag, "supervisor.html");
        clientApp.loadSupervisorView();
        clientApp.purecloudClientApi = new window.purecloud.apps.ClientApp();

        window.clientApp = clientApp;
    </script>
    <script>
        function subscribeToQueue() {
            var queue = document.getElementById("ddlQueues");
            var queueValue = document.getElementById("ddlQueues").value;
            var queueText = queue.options[queue.selectedIndex].text;

            clientApp.subscribeToQueue(queueValue);
        }

        function allConversations() {
            var table = document.getElementById("tblCallerDetails");
            var tr = table.getElementsByTagName("tr");

            for (var i = 0; i < tr.length; i++) {
                tr[i].style.display = "";
            }
        }

        function phoneConversations() {
            var table = document.getElementById("tblCallerDetails");
            var tr = table.getElementsByTagName("tr");

            // Loop through all table rows, and hide those who don't match the search query
            for (var i = 0; i < tr.length; i++) {
                var td = tr[i].getElementsByTagName("td")[1];
                if (td) {
                    if (td.innerHTML.search(/\bCall\b/) > -1) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                } 
            }
        }

        function callbackConversations() {
            var table = document.getElementById("tblCallerDetails");
            var tr = table.getElementsByTagName("tr");

            // Loop through all table rows, and hide those who don't match the search query
            for (var i = 0; i < tr.length; i++) {
                var td = tr[i].getElementsByTagName("td")[1];
                if (td) {
                    if (td.innerHTML.search(/\bCallback\b/) > -1) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                } 
            }
        }

        function chatConversations() {
            var table = document.getElementById("tblCallerDetails");
            var tr = table.getElementsByTagName("tr");

            // Loop through all table rows, and hide those who don't match the search query
            for (var i = 0; i < tr.length; i++) {
                var td = tr[i].getElementsByTagName("td")[1];
                if (td) {
                    if (td.innerHTML.search(/\bChat\b/) > -1) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                } 
            }
        }

        function emailConversations() {
            var table = document.getElementById("tblCallerDetails");
            var tr = table.getElementsByTagName("tr");

            // Loop through all table rows, and hide those who don't match the search query
            for (var i = 0; i < tr.length; i++) {
                var td = tr[i].getElementsByTagName("td")[1];
                if (td) {
                    if (td.innerHTML.search(/\bEmail\b/) > -1) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                } 
            }
        }
    </script>
</body>
</html>
